autoload -U colors
colors

# disable XON/XOFF flow control
stty -ixon

# Plugins
source $HOME/.zsh/plugin/syntax-highlighting/zsh-syntax-highlighting.zsh
ZSH_HIGHLIGHT_HIGHLIGHTERS=(main root brackets)

# History
HISTFILE=$HOME/.zsh_history
HISTSIZE=10000
SAVEHIST=10000

setopt append_history
setopt extended_history
setopt hist_expire_dups_first
setopt hist_ignore_dups
setopt hist_ignore_space
setopt hist_verify
setopt inc_append_history
setopt share_history

# Completion
unsetopt menu_complete
unsetopt flowcontrol
setopt auto_menu
setopt complete_in_word
setopt always_to_end

zstyle ':completion:*' matcher-list 'm:{a-zA-z}={A-Za-z}' 'r:|[._-]=* r:|=*' 'l:|=* r:|=*'
zstyle ':completion:*:*:*:*:*:' menu select
zstyle ':completion:*:*:*:*:processes' command "ps -u `whoami` -o pid,user,comm -w -W"
zstyle ':completion:*:cd:*' tag-order local-directories directory-stack path-directories
zstyle ':completion::complete:*' use-cache 1
zstyle ':completion::complete:*' cache-path $ZSH/cache/

# Version Control
autoload -Uz vcs_info
zstyle ':vcs_info:*' enable bzr cdv cvs darcs fossil git tla hg mtn p4 svn svk
zstyle ':vcs_info:*' get-revision false
zstyle ':vcs_info:*' use-simple true
zstyle ':vcs_info:*' check-for-changes true
zstyle ':vcs_info:*' stagedstr "%{$fg_bold[green]%}✓"
zstyle ':vcs_info:*' unstagedstr "%{$fg_bold[yellow]%}✕"
zstyle ':vcs_info:*' formats " %{$fg_bold[white]%}‹%{$fg[cyan]%}%b%c%u%{$fg_bold[white]%}›"
zstyle ':vcs_info:*' actionformats " %{$fg_bold[white]%}‹%{$fg[cyan]%}%b%c%u%{$fg_bold[red]%}⚡%{$fg_bold[white]%}›"

precmd() {
	vcs_info
}

# Alias
alias ls="ls --color=auto --group-directories-first"
alias ll="ls --color=auto --group-directories-first -l"
alias la="ls --color=auto --group-directories-first -lA"

alias grep="grep --color=auto"

alias mv="nocorrect mv"
alias cp="nocorrect cp"
alias mkdir="nocorrect mkdir"

cd() {
	builtin cd "$@"; print "$fg[green]$PWD$reset_color"
}

pwd() {
	printf "$fg[green]$PWD$reset_color\n"
}

# Prompt
setopt prompt_subst
PROMPT='%{$fg[blue]%}%c${vcs_info_msg_0_} %{$fg_bold[white]%}» %{$reset_color%}'
RPROMPT=''

# Path
typeset -U path
path=("$HOME/bin" $path)
export PATH
