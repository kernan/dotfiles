function prompt_custom_precmd {
	vcs_info
	if (( $+functions[git-info] )); then
		git-info
	fi
}

function prompt_custom_setup {
	prompt_opts=(percent subst)

	# load required functions
	autoload -Uz add-zsh-hook
	autoload -Uz vcs_info

	# add hook for calling vcs_info before each command
	add-zsh-hook precmd prompt_custom_precmd

	# setup editor-info parameters
	zstyle ':prezto:module:editor:info:completing' format '%F{red}...%f'
	zstyle ':prezto:module:editor:info:keymap:primary' format '%F{white}%B»%b%f'
	zstyle ':prezto:module:editor:info:keymap:alternate' format '%F{red}%B«%b%f'

	# setup vcs_info
	zstyle ':vcs_info:*' enable bzr cdv cvs darcs fossil git tla hg mtn p4 svn svk
	zstyle ':vcs_info:*' check-for-changes true
	zstyle ':vcs_info:*' stagedstr '%F{green}%B✓%b%f'
	zstyle ':vcs_info:*' unstagedstr '%F{yellow}%B✕%b%f'
	zstyle ':vcs_info:*' formats ' %F{white}%B‹%%b%F{cyan}%b%c%u%F{white}%B›%%b%f'
	zstyle ':vcs_info:*' actionformats ' %F{white}%B‹%F{red}⚡%%b%F{cyan}%b%c%u%F{white}%B›%%b%f'

	# set prompt
	PROMPT='%F{blue}%c${vcs_info_msg_0_} ${editor_info[keymap]} '
	RPROMPT=''
	SPROMPT='correct %F{red}%R%f to %F{green}%r%f [nyae]? '
}

prompt_custom_setup "%@"

cd() {
	builtin cd "$@"
	builtin pwd
}

# vim:set filetype=zsh:
